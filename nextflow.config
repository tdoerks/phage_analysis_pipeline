// Nextflow configuration for K-State Beocat HPC
params {
    // Input parameters
    assemblies = "path/to/your/assemblies/*.fasta"
    outdir = "results"
    // Resource limits
    max_memory = '100.GB'
    max_cpus = 16
    max_time = '24.h'
}

// Apptainer configuration
apptainer {
    enabled = true
    autoMounts = true
    cacheDir = "$HOME/.apptainer/cache"
}

// Use local executor - run all processes within the main job
executor {
    name = 'local'
    cpus = 16
    memory = '100.GB'
}

// Process-specific configurations
process {
    executor = 'local'
    
    // Process-specific resource allocation
    withName: 'VIBRANT' {
        container = 'docker://staphb/vibrant'
        memory = '32.GB'
        cpus = 8
    }
    withName: 'DIAMOND_PROPHAGE' {
        container = 'docker://staphb/diamond'
        memory = '16.GB'
        cpus = 4
    }
    withName: 'CHECKV' {
        container = 'docker://staphb/checkv'
        memory = '8.GB'
        cpus = 2
    }
    withName: 'PHANOTATE' {
        container = 'docker://staphb/phanotate'
        memory = '4.GB'
        cpus = 2
    }
    withName: 'COMBINE_RESULTS' {
        memory = '4.GB'
        cpus = 1
    }
    withName: 'DOWNLOAD_PROPHAGE_DB' {
        container = 'docker://staphb/diamond'
        memory = '8.GB'
        cpus = 2
    }
}

// Error handling
process.shell = ['/bin/bash', '-euo', 'pipefail']
